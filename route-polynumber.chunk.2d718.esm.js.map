{"version":3,"sources":["webpack:///./routes/common/webgl2/index.tsx","webpack:///./routes/common/canvas/style.css","webpack:///./routes/polynumber/fragment.js","webpack:///./routes/common/canvas/index.tsx","webpack:///./routes/common/grid-overlay/style.css","webpack:///./routes/common/grid-overlay/index.tsx","webpack:///./routes/polynumber/index.tsx","webpack:///./routes/polynumber/vertex.js"],"names":["defaultContextOptions","alpha","depth","preserveDrawingBuffer","WebGL2","props","getContext","init","ready","draw","onResize","framesPerSecond","rest","ref","createRef","frameMilliseconds","undefined","useEffect","canvas","current","renderCallbackID","paused","frameCount","ctx","alert","window","location","href","handleResize","width","innerWidth","height","innerHeight","addEventListener","handleBlur","handleFocus","setFullscreen","document","fullscreenElement","body","requestFullscreen","catch","err","console","error","render","setTimeout","requestAnimationFrame","whenReady","clearTimeout","cancelAnimationFrame","removeEventListener","Canvas","animate","loopCallbackID","loop","canvasMethodRefs","axisLabelFormat","d","n","repeat","zoomFactor","microZoomFactor","free","GridOverlay","setTranslate","setScale","log","canvasCenter","translate","scale","velocity","xLabelOffset","fontSize","yLabelOffset","contextHeight","strokeStyle","fillStyle","textAlign","lineWidth","font","initialScale","clearRect","powerX","Math","ceil","log10","powerY","factorX","factorY","spaceX","spaceY","xIndexOffset","yIndexOffset","firstXPosition","firstYPosition","xLineCount","floor","yLineCount","xMiddleLineIndex","yMiddleLineIndex","beginPath","i","x","moveTo","lineTo","j","label","fillText","y","stroke","mouseDown","lastMousePosition","lastTouch1Position","lastTouch2Position","handleMouseDown","event","button","clientX","clientY","preventDefault","handleMouseUp","handleContextMenu","handleMouseMove","dx","dy","f","zoomTo","zoomLastPosition","zoomToPosition","handleTouchDown","touches","pageX","pageY","handleTouchUp","handleTouchMove","length","x1","y1","x2","y2","zoomModifier","touchMidpoint","deltaY","handleKeyDown","code","class","style","initShader","gl","type","source","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","PolynumberVisualizer","path","library","default","polynumber","shaderProgram","timeUniform","translateUniform","scaleUniform","uniform1f","uniform2f","drawArrays","TRIANGLE_STRIP","polyrat","Polyrat","coefficents","Helmet","title","id","for","rows","fragmentShaderSource","replace","toGLSLFormula","program","createProgram","getElementById","textContent","fragmentShader","FRAGMENT_SHADER","attachShader","vertexShaderSource","vertexShader","VERTEX_SHADER","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","useProgram","initProgram","positionAttrib","getAttribLocation","vertices","Float32Array","vertexBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","vertexAttribPointer","FLOAT","enableVertexAttribArray","getUniformLocation","bindBuffers","viewport","clear","COLOR_BUFFER_BIT"],"mappings":"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","file":"route-polynumber.chunk.2d718.esm.js","sourcesContent":["import { FunctionalComponent, createRef, h } from 'preact'\nimport { useEffect } from 'preact/hooks'\n\ntype GetContextFunction = (webGL2: HTMLCanvasElement) => WebGL2RenderingContext\n\ntype InitFunction = (ctx: WebGL2RenderingContext) => void\n\ntype ReadyFunction = (whenReady: VoidFunction) => void\n\ntype DrawFunction = (ctx: WebGL2RenderingContext, frameCount: number) => void\n\ntype ResizeFunction = (ctx: WebGL2RenderingContext) => void\n\ninterface WebGL2Options {\n  contextType?: string;\n  framesPerSecond?: number;\n}\n\ninterface WebGL2Props {\n  getContext?: GetContextFunction;\n  init?: InitFunction;\n  ready?: ReadyFunction;\n  draw: DrawFunction;\n  onResize?: ResizeFunction;\n  framesPerSecond?: number;\n  options?: WebGL2Options;\n}\n\nconst defaultContextOptions = {\n  alpha: false,\n  depth: false,\n  preserveDrawingBuffer: true\n}\n\nexport const WebGL2: FunctionalComponent<WebGL2Props> = (props: WebGL2Props) => {\n  const { getContext, init, ready, draw, onResize, framesPerSecond, ...rest } = props\n  const ref = createRef()\n  const frameMilliseconds = framesPerSecond ? 1000 / framesPerSecond : undefined\n\n  useEffect(() => {\n    const canvas = ref.current as HTMLCanvasElement\n    let paused = false\n    let frameCount = -1\n    let renderCallbackID: number\n    const ctx = getContext ? getContext(canvas) : canvas.getContext('webgl2', defaultContextOptions) as WebGL2RenderingContext\n    if (!ctx) {\n      alert('Error getting context. WebGL2 is required.')\n      window.location.href='https://get.webgl.org/webgl2/'\n      return\n    }\n\n    const handleResize = (): void => {\n      ctx.canvas.width = window.innerWidth\n      ctx.canvas.height = window.innerHeight\n      if (onResize) onResize(ctx)\n    }\n    window.addEventListener('resize', handleResize)\n    handleResize()\n\n    const handleBlur = (): void => {\n      paused = true\n    }\n    window.addEventListener('blur', handleBlur)\n\n    const handleFocus = (): void => {\n      paused = false\n    }\n    window.addEventListener('focus', handleFocus)\n\n    const setFullscreen = (): void => {\n      if (!document.fullscreenElement) {\n        document.body.requestFullscreen().catch(err => {\n          console.error('Fullscreen fail:', err)\n        })\n      }\n    }\n    window.addEventListener('click', setFullscreen)\n\n    if (init) init(ctx)\n\n    const render = (): void => {\n      if (paused) {\n        setTimeout(render, 128)\n        return\n      }\n      frameCount++\n      if (frameMilliseconds) {\n        renderCallbackID = window.setTimeout(render, frameMilliseconds)\n      }\n      else {\n        renderCallbackID = window.requestAnimationFrame(render)\n      }\n      draw(ctx, frameCount)\n    }\n\n    const whenReady = (): void => {\n      setTimeout(render, 0)\n    }\n\n    if (ready===undefined) whenReady()\n    else ready(whenReady)\n\n    return (): void => {\n      if (frameMilliseconds) {\n        window.clearTimeout(renderCallbackID)\n      }\n      else {\n        window.cancelAnimationFrame(renderCallbackID)\n      }\n      window.removeEventListener('resize', handleResize)\n      window.removeEventListener('blur', handleBlur)\n      window.removeEventListener('focus', handleFocus)\n      window.removeEventListener('click', setFullscreen)\n    }\n\n  }, [getContext, init, ready, draw, onResize, ref, frameMilliseconds])\n\n  return <canvas ref={ref} {...rest} />\n}\n\nexport default WebGL2\n","// extracted by mini-css-extract-plugin\nexport default {\"canvas_frame\":\"canvas_frame__1myZW\",\"art_plaque\":\"art_plaque__2F3EQ\"};","export default `#version 300 es\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nuniform float u_time;\nuniform vec2 u_translate;\nuniform vec2 u_scale;\nout vec4 fragmentColor;\n\nvoid main() {\n  float x = ( gl_FragCoord.x + u_translate.x ) * u_scale.x;\n  float y = ( gl_FragCoord.y + u_translate.y ) * u_scale.y;\n  float x2 = x*x;\n  float y2 = y*y;\n\n  float z = POLYNUMBER_FORMULA;\n\n  fragmentColor.r = mod(z + u_time / 43.0, 1.0);\n  fragmentColor.g = z < 1.0 ? z : 1.0 / z;\n  fragmentColor.b = mod(z - u_time / 73.0, 1.0);\n}\n`\n","import { FunctionalComponent, createRef, h } from 'preact'\nimport { useEffect } from 'preact/hooks'\n\ntype GetContextFunction = (canvas: HTMLCanvasElement) => CanvasRenderingContext2D\n\ntype InitFunction = (ctx: CanvasRenderingContext2D) => void\n\ntype ReadyFunction = (whenReady: VoidFunction) => void\n\ntype DrawFunction = (ctx: CanvasRenderingContext2D, frameCount: number) => void\n\ntype ResizeFunction = (ctx: CanvasRenderingContext2D) => void\n\ntype RenderFunction = () => void\n\nexport interface CanvasOptions {\n  contextType?: string;\n  framesPerSecond?: number;\n}\n\nexport interface CanvasMethods {\n  render: RenderFunction;\n}\n\nexport interface CanvasProps {\n  getContext?: GetContextFunction;\n  init?: InitFunction;\n  ready?: ReadyFunction;\n  draw: DrawFunction;\n  onResize?: ResizeFunction;\n  animate?: boolean;\n  framesPerSecond?: number;\n  options?: CanvasOptions;\n  canvasMethodRefs?: CanvasMethods;\n}\n\nexport const Canvas: FunctionalComponent<CanvasProps> = (props: CanvasProps) => {\n  const { getContext, init, ready, draw, onResize, animate, framesPerSecond, ...rest } = props\n  const ref = createRef()\n  const frameMilliseconds = framesPerSecond ? 1000 / framesPerSecond : undefined\n\n  useEffect(() => {\n    const canvas = ref.current as HTMLCanvasElement\n    let paused = false\n    let frameCount = -1\n    let loopCallbackID: number\n    const ctx = getContext ? getContext(canvas) : canvas.getContext('2d') as CanvasRenderingContext2D\n\n    const handleResize = (): void => {\n      ctx.canvas.width = window.innerWidth\n      ctx.canvas.height = window.innerHeight\n      if (onResize) onResize(ctx)\n    }\n    window.addEventListener('resize', handleResize)\n    handleResize()\n\n    const handleBlur = (): void => {\n      paused = true\n    }\n    window.addEventListener('blur', handleBlur)\n\n    const handleFocus = (): void => {\n      paused = false\n    }\n    window.addEventListener('focus', handleFocus)\n\n    const setFullscreen = (): void => {\n      if (!document.fullscreenElement) {\n        document.body.requestFullscreen().catch(err => {\n          console.error('Fullscreen fail:', err)\n          // console.error(`Fullscreen fail: ${err.message} (${err.name})`)\n        })\n      }\n    }\n    window.addEventListener('click', setFullscreen)\n\n    if (init) init(ctx)\n\n    const render = (): void => {\n      draw(ctx, frameCount++)\n    }\n\n    const loop = (): void => {\n      if (paused) {\n        setTimeout(loop, 128)\n        return\n      }\n      frameCount++\n      if (frameMilliseconds) {\n        loopCallbackID = window.setTimeout(loop, frameMilliseconds)\n      }\n      else {\n        loopCallbackID = window.requestAnimationFrame(loop)\n      }\n      draw(ctx, frameCount)\n    }\n\n    // expose methods to parent\n    // @todo seems parents calling their children's methods is react antipattern, better way?\n    if (props.canvasMethodRefs) {\n      props.canvasMethodRefs.render = render\n    }\n\n    const whenReady = (): void => {\n      if (animate===false) {\n        setTimeout(render)\n      }\n      else {\n        setTimeout(loop)\n      }\n    }\n\n    if (ready===undefined) whenReady()\n    else ready(whenReady)\n\n    return (): void => {\n      if (frameMilliseconds) {\n        window.clearTimeout(loopCallbackID)\n      }\n      else {\n        window.cancelAnimationFrame(loopCallbackID)\n      }\n      window.removeEventListener('resize', handleResize)\n      window.removeEventListener('blur', handleBlur)\n      window.removeEventListener('focus', handleFocus)\n      window.removeEventListener('click', setFullscreen)\n    }\n\n  }, [getContext, init, ready, draw, onResize, ref, props.canvasMethodRefs, animate, frameMilliseconds])\n\n  return <canvas ref={ref} {...rest} />\n}\n\nexport default Canvas\n","// extracted by mini-css-extract-plugin\nexport default {\"grid_overlay\":\"grid_overlay__3wiLR\"};","import { FunctionalComponent, h } from 'preact'\nimport { useEffect } from 'preact/hooks'\nimport Canvas, { CanvasMethods } from '../../common/canvas'\nimport style from './style.css'\n\nexport const axisLabelFormat = (d: number, n: number): string => {\n  if (d === 0) return '0'\n  if (n > -1 && n < 4) {\n    return `${d}${'0'.repeat(n)}`\n  }\n  return `${d}⏨${n}`\n}\n\ntype TranslateFunction = (x: number, y: number) => void\n\ntype ScaleFunction = (x: number, y: number) => void\n\nexport interface GridOverlayProps {\n  canvasMethodRefs?: CanvasMethods;\n  setTranslate?: TranslateFunction;\n  setScale?: ScaleFunction;\n  initialScale?: number;\n}\n\nconst logBase = 10\nconst zoomFactor = logBase**(1/13)\nconst microZoomFactor = zoomFactor**(1/32)\nconst minimumGridSpacing = 24\nconst μ = .9\nconst translateFactor = 16\nlet free = true\n\nexport const GridOverlay: FunctionalComponent<GridOverlayProps> = (props: GridOverlayProps) => {\n  const { setTranslate, setScale, ...rest } = props\n  const canvasMethodRefs = {render() {console.log('canvasMethodRefs.render()')}}\n  const canvasCenter = [0, 0]\n  const translate = [0, 0]\n  const scale = [1, 1]\n  const velocity = [0, 0]\n  const fontSize = 12\n  const axisLabelMargin = 4\n  const xLabelOffset = [-axisLabelMargin, fontSize+axisLabelMargin]\n  const yLabelOffset = [-axisLabelMargin, -axisLabelMargin]\n  let contextHeight = 0\n\n  const init = (ctx: CanvasRenderingContext2D): void => {\n    ctx.strokeStyle = '#999' // lines\n    ctx.fillStyle = '#ccc' // text\n    ctx.textAlign = 'right'\n    ctx.lineWidth = 1\n    ctx.font = `${fontSize}px monospace`\n    contextHeight = ctx.canvas.height\n    canvasCenter[0] = ctx.canvas.width/2\n    canvasCenter[1] = ctx.canvas.height/2\n    translate[0] = -canvasCenter[0]\n    translate[1] = -canvasCenter[1]\n    const initialScale = rest.initialScale ?? 64/ctx.canvas.width\n    scale[0] = scale[1] = initialScale\n    if (setScale) {\n      setScale(scale[0], scale[1])\n    } \n    draw(ctx)\n  }\n\n  const render = (): void => {\n    if (canvasMethodRefs && 'render' in canvasMethodRefs) {\n      canvasMethodRefs.render()\n    }\n  }\n\n  const draw = (ctx: CanvasRenderingContext2D): void => {\n    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height)\n\n    // slow down due to friction\n    velocity[0] *= μ\n    velocity[1] *= μ\n\n    // glide\n    if (free) {\n      translate[0] += velocity[0]\n      translate[1] -= velocity[1]\n    }\n    \n    // exponent for axis labels ⏨(n+x)\n    const powerX = Math.ceil(Math.log10(minimumGridSpacing * scale[0]))\n    const powerY = Math.ceil(Math.log10(minimumGridSpacing * scale[1]))\n    const factorX = 10**powerX\n    const factorY = 10**powerY\n\n    // set space between lines\n    const spaceX = factorX / scale[0]\n    const spaceY = factorY / scale[1]\n\n    // get first lines by rounding up\n    const xIndexOffset = Math.ceil(translate[0] * scale[0] / factorX)\n    const yIndexOffset = Math.ceil(translate[1] * scale[1] / factorY) \n    const firstXValue = xIndexOffset * factorX\n    const firstYValue = yIndexOffset * factorY\n    const firstXPosition = firstXValue / scale[0] - translate[0]\n    const firstYPosition = translate[1] - firstYValue / scale[1]\n    \n    // lines to write labels on\n    const xLineCount = Math.floor(ctx.canvas.width / spaceX)\n    const yLineCount = Math.floor(ctx.canvas.height / spaceY)\n    const xMiddleLineIndex = Math.floor(xLineCount / 2)\n    const yMiddleLineIndex = Math.floor(yLineCount / 2)\n\n    ctx.beginPath()\n    // draw x-axis grid lines\n    for (let i=0; i<=xLineCount; i++) {\n      const x = firstXPosition + i * spaceX\n      ctx.moveTo(x, 0)\n      ctx.lineTo(x, ctx.canvas.height)\n      // draw y-axis labels up the middle line\n      if (i === xMiddleLineIndex) {\n        for (let j=0; j<=yLineCount; j++) {\n          const label = axisLabelFormat(j + yIndexOffset, powerY)\n          const y = firstYPosition + ctx.canvas.height - j * spaceY\n          ctx.fillText(label, x + yLabelOffset[0], y + yLabelOffset[1])\n        }\n      }\n    }\n    // draw y-axis grid lines\n    for (let i=0; i<=yLineCount; i++) {\n      const y = firstYPosition + ctx.canvas.height - i * spaceY\n      ctx.moveTo(0, y)\n      ctx.lineTo(ctx.canvas.width, y)\n      // draw x-axis labels below the middle line\n      if (i === yMiddleLineIndex) {\n        for (let j=0; j<=xLineCount; j++) {\n          const label = axisLabelFormat(j + xIndexOffset, powerX)\n          const x = firstXPosition + j * spaceX\n          ctx.fillText(label, x + xLabelOffset[0], y + xLabelOffset[1])\n        }\n      }\n    }\n    ctx.stroke()\n\n    // update position of main canvas\n    if (setTranslate) {\n      setTranslate(translate[0], translate[1])\n    }\n  }\n\n  useEffect(() => {\n    let mouseDown = 0\n    let renderCallbackID: number\n    const lastMousePosition = [0, 0]\n    const lastTouch1Position = [-1, -1]\n    const lastTouch2Position = [-1, -1]\n\n    const handleMouseDown = (event: MouseEvent): boolean => {\n      mouseDown |= (1<<event.button)\n      lastMousePosition[0] = event.clientX\n      lastMousePosition[1] = event.clientY\n      velocity[0] = velocity[1] = 0\n      free = !(mouseDown&1)\n      event.preventDefault()\n      return false\n    }\n    window.addEventListener('mousedown', handleMouseDown)\n\n    const handleMouseUp = (event: MouseEvent): boolean => {\n      mouseDown ^= (1<<event.button)\n      event.preventDefault()\n      free = !(mouseDown&1)\n      return false\n    }\n    window.addEventListener('mouseup', handleMouseUp)\n\n    const handleContextMenu = (event: MouseEvent): boolean => {\n      event.preventDefault()\n      return false\n    }\n    window.addEventListener('contextmenu', handleContextMenu)\n\n    const handleMouseMove = (event: MouseEvent): void => {\n      const dx = lastMousePosition[0] - event.clientX\n      const dy = lastMousePosition[1] - event.clientY\n      const flingFactor = 4\n      // left-clicked, translate\n      if (mouseDown&1) {\n        velocity[0] = dx * flingFactor\n        velocity[1] = dy * flingFactor\n        translate[0] += dx\n        translate[1] -= dy\n        if (setTranslate) {\n          setTranslate(translate[0], translate[1])\n          render()\n        }\n      }\n      // middle-clicked, scale all axes\n      if (mouseDown&2) {\n        const f = microZoomFactor**-dy\n        scale[0] *= f\n        scale[1] *= f\n        if (setScale) {\n          setScale(scale[0], scale[1])\n          render()\n        } \n      }\n      // right-clicked, scale individual axes\n      if (mouseDown&4) {\n        const zoomTo = [\n          (lastMousePosition[0] + translate[0]) * scale[0],\n          (contextHeight - lastMousePosition[1] + translate[1]) * scale[1]\n        ]\n        const zoomLastPosition = [\n          zoomTo[0] / scale[0] - translate[0],\n          zoomTo[1] / scale[1] - translate[1]\n        ]\n        scale[0] *= microZoomFactor**dx\n        scale[1] *= microZoomFactor**-dy\n        if (setScale) {\n          setScale(scale[0], scale[1])\n        }\n        const zoomToPosition = [\n          zoomTo[0] / scale[0] - translate[0],\n          zoomTo[1] / scale[1] - translate[1]\n        ]\n        translate[0] -= zoomLastPosition[0] - zoomToPosition[0] - dx\n        translate[1] += zoomToPosition[1] - zoomLastPosition[1] - dy\n        if (setTranslate) {\n          setTranslate(translate[0], translate[1])\n        }\n        render()\n      }\n      lastMousePosition[0] = event.clientX\n      lastMousePosition[1] = event.clientY\n    }\n    window.addEventListener('mousemove', handleMouseMove)\n\n    const handleTouchDown = (event: TouchEvent): boolean => {\n      lastTouch1Position[0] = event.touches[0].pageX\n      lastTouch1Position[1] = event.touches[0].pageY\n      velocity[0] = velocity[1] = 0\n      free = false\n      return false\n    }\n    window.addEventListener('touchstart', handleTouchDown)\n\n    const handleTouchUp = (event: TouchEvent): boolean => {\n      void(event)\n      lastTouch1Position[0] = lastTouch1Position[1] = -1\n      free = true\n      return false\n    }\n    window.addEventListener('touchend', handleTouchUp)\n\n    const handleTouchMove = (event: TouchEvent): void => {\n      if (lastTouch1Position[0] > -1) {\n        if (event.touches.length===1) {\n          const dx = lastTouch1Position[0] - event.touches[0].pageX\n          const dy = lastTouch1Position[1] - event.touches[0].pageY\n          velocity[0] = dx\n          velocity[1] = dy\n          translate[0] += dx\n          translate[1] -= dy\n          lastTouch2Position[0] = lastTouch2Position[1] = -1\n          if (setTranslate) {\n            setTranslate(translate[0], translate[1])\n            render()\n          }\n        }\n        else {\n          if (lastTouch2Position[0] > -1) {\n            const x1 = event.touches[0].pageX\n            const y1 = event.touches[0].pageY\n            const x2 = event.touches[1].pageX\n            const y2 = event.touches[1].pageY\n            const q1 = (lastTouch1Position[0] - lastTouch2Position[0])**2 + (lastTouch1Position[1] - lastTouch2Position[1])**2\n            const q2 = (x1 - x2)**2 + (y1 - y2)**2\n            const zoomModifier = q1 / q2\n            const touchMidpoint = [\n              (x1 + x2) / 2,\n              (y1 + y2) / 2\n            ]\n            const zoomTo = [\n              (touchMidpoint[0] + translate[0]) * scale[0],\n              (contextHeight - touchMidpoint[1] + translate[1]) * scale[1]\n            ]\n            const zoomLastPosition = [\n              zoomTo[0] / scale[0] - translate[0],\n              zoomTo[1] / scale[1] - translate[1]\n            ]\n            scale[0] *= zoomModifier\n            scale[1] *= zoomModifier\n            if (setScale) {\n              setScale(scale[0], scale[1])\n            }\n            const zoomToPosition = [\n              zoomTo[0] / scale[0] - translate[0],\n              zoomTo[1] / scale[1] - translate[1]\n            ]\n            translate[0] -= zoomLastPosition[0] - zoomToPosition[0]\n            translate[1] += zoomToPosition[1] - zoomLastPosition[1]\n            if (setTranslate) {\n              setTranslate(translate[0], translate[1])\n            }\n            render()\n          }\n          lastTouch2Position[0] = event.touches[1].pageX\n          lastTouch2Position[1] = event.touches[1].pageY\n        }\n      }\n      lastTouch1Position[0] = event.touches[0].pageX\n      lastTouch1Position[1] = event.touches[0].pageY\n    }\n    window.addEventListener('touchmove', handleTouchMove)\n\n    const handleWheel = (event: WheelEvent): void => {\n      const zoomModifier = event.deltaY > 0 ? zoomFactor : 1/zoomFactor\n      const zoomTo = [\n        (lastMousePosition[0] + translate[0]) * scale[0],\n        (contextHeight - lastMousePosition[1] + translate[1]) * scale[1]\n      ]\n      const zoomLastPosition = [\n        zoomTo[0] / scale[0] - translate[0],\n        zoomTo[1] / scale[1] - translate[1]\n      ]\n      scale[0] *= zoomModifier\n      scale[1] *= zoomModifier\n      if (setScale) {\n        setScale(scale[0], scale[1])\n      }\n      const zoomToPosition = [\n        zoomTo[0] / scale[0] - translate[0],\n        zoomTo[1] / scale[1] - translate[1]\n      ]\n      translate[0] -= zoomLastPosition[0] - zoomToPosition[0]\n      translate[1] += zoomToPosition[1] - zoomLastPosition[1]\n      if (setTranslate) {\n        setTranslate(translate[0], translate[1])\n      }\n      render()\n    }\n    window.addEventListener('wheel', handleWheel)\n\n    const handleKeyDown = (event: KeyboardEvent): void => {\n      switch (event.code) {\n  \n      case 'KeyW':\n      case 'ArrowUp':\n      case 'Numpad8':\n        translate[1] -= translateFactor * zoomFactor\n        break\n            \n      case 'KeyS':\n      case 'ArrowDown':\n      case 'Numpad2':\n        translate[1] += translateFactor * zoomFactor\n        break\n             \n      case 'KeyA':\n      case 'ArrowLeft':\n      case 'Numpad4':\n        translate[0] += translateFactor * zoomFactor\n        break\n            \n      case 'KeyD':\n      case 'ArrowRight':\n      case 'Numpad6':\n        translate[0] -= translateFactor * zoomFactor\n        break\n \n      case 'NumpadSubtract':\n      case 'Minus':\n        scale[0] *= zoomFactor\n        scale[1] *= zoomFactor\n        if (setScale) {\n          setScale(scale[0], scale[1])\n          render()\n        } \n        break\n \n      case 'NumpadAdd':\n      case 'Equal':\n        scale[0] /= zoomFactor\n        scale[1] /= zoomFactor\n        if (setScale) {\n          setScale(scale[0], scale[1])\n          render()\n        } \n        break\n  \n      }\n    }\n    window.addEventListener('keydown', handleKeyDown)\n\n    return (): void => {\n      window.cancelAnimationFrame(renderCallbackID)\n      window.removeEventListener('mousedown', handleMouseDown)\n      window.removeEventListener('mouseup', handleMouseUp)\n      window.removeEventListener('contextmenu', handleContextMenu)\n      window.removeEventListener('mousemove', handleMouseMove)\n      window.removeEventListener('touchstart', handleTouchDown)\n      window.removeEventListener('touchend', handleTouchUp)\n      window.removeEventListener('touchmove', handleTouchMove)\n      window.removeEventListener('keypress', handleKeyDown)\n    }\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  return (\n    <div class={style.grid_overlay} {...rest}>\n      <Canvas canvasMethodRefs={canvasMethodRefs} init={init} onResize={init} draw={draw} animate={true} />\n    </div>\n  )\n}\n\nexport default GridOverlay\n","/* eslint-disable @typescript-eslint/no-unsafe-argument */\nimport { createRef, FunctionalComponent, h } from 'preact'\nimport Helmet from 'react-helmet'\nimport WebGL2 from '../common/webgl2'\nimport NotFound from '../not-found'\nimport style from '../common/canvas/style.css'\nimport fragmentShaderSource from './fragment.js'\nimport vertexShaderSource from './vertex.js'\nimport GridOverlay from '../common/grid-overlay'\nimport library from '../polynumbers/library'\nimport { PolynumberPlaque } from '../polynumbers/meta'\nimport Polyrat from 'cnum/dist/tsc/Polyrat'\n\nconst initShader = (gl: WebGL2RenderingContext, type: number, source: string): WebGLShader => {\n  const shader = gl.createShader(type)\n  if (!shader) {\n    throw 'Missing shader'\n  }\n  gl.shaderSource(shader, source)\n  gl.compileShader(shader)\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    throw gl.getShaderInfoLog(shader)\n  }\n  return shader\n}\n\nconst initProgram = (gl: WebGL2RenderingContext): WebGLProgram => {\n  const program = gl.createProgram()\n  if (!program) {\n    throw 'Missing program'\n  }\n  const fragmentShaderSource = document.getElementById('fragmentShader')?.textContent\n  if (!fragmentShaderSource) {\n    throw 'Missing fragmentShaderSource'\n  }\n  const fragmentShader = initShader(gl, gl.FRAGMENT_SHADER, fragmentShaderSource)\n  gl.attachShader(program, fragmentShader)\n  const vertexShaderSource = document.getElementById('vertexShader')?.textContent\n  if (!vertexShaderSource) {\n    throw 'Missing vertexShaderSource'\n  }\n  const vertexShader = initShader(gl, gl.VERTEX_SHADER, vertexShaderSource)\n  gl.attachShader(program, vertexShader)\n  gl.linkProgram(program)\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n    throw gl.getProgramInfoLog(program)??'Error from getProgramParameter'\n  }\n  gl.useProgram(program)\n  return program\n}\n\ninterface Props {\n  path: keyof typeof library;\n}\n\nconst PolynumberVisualizer: FunctionalComponent<Props> = (props: Props) => {\n  const { path } = props\n  \n  if (!(path in library)) {\n    return <NotFound default />\n  }\n  const polynumber = library[path]\n\n  const ref = createRef<HTMLElement>()\n  let shaderProgram: WebGLProgram\n  let timeUniform: WebGLUniformLocation|null\n  let translateUniform: WebGLUniformLocation|null\n  let scaleUniform: WebGLUniformLocation|null\n  const translate = [0, 0]\n  const scale = [1, 1]\n\n  const bindBuffers = (gl: WebGL2RenderingContext, program: WebGLProgram): void => {\n    const positionAttrib = gl.getAttribLocation(program, 'a_position')\n    const vertices = new Float32Array([\n      +1, +1, +0,\n      -1, +1, +0,\n      +1, -1, +0,\n      -1, -1, +0\n    ])\n    const vertexBuffer = gl.createBuffer()\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer)\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW)\n    gl.vertexAttribPointer(positionAttrib, 3, gl.FLOAT, false, 0, 0)\n    gl.bindBuffer(gl.ARRAY_BUFFER, null) // unbind\n    gl.enableVertexAttribArray(positionAttrib)\n    timeUniform = gl.getUniformLocation(program, 'u_time')\n    translateUniform = gl.getUniformLocation(program, 'u_translate')\n    scaleUniform = gl.getUniformLocation(program, 'u_scale')\n  }\n  \n  const init = (ctx: WebGL2RenderingContext): void => {\n    translate[0] = -ctx.canvas.width/2\n    translate[1] = -ctx.canvas.height/2\n    shaderProgram = initProgram(ctx)\n    bindBuffers(ctx, shaderProgram)\n  }\n\n  const onResize = (ctx: WebGL2RenderingContext): void => {\n    ctx.viewport(0, 0, ctx.canvas.width, ctx.canvas.height)\n    ctx.clear(ctx.COLOR_BUFFER_BIT)\n    draw(ctx, -1)\n  }\n\n  const setTranslate = (x: number, y: number): void => {\n    translate[0] = x\n    translate[1] = y\n  }\n\n  const setScale = (x: number, y: number): void => {\n    scale[0] = x\n    scale[1] = y\n    setTranslate(0, 0)\n  }\n\n  const draw = (ctx: WebGL2RenderingContext, frameCount: number): void => {\n    ctx.uniform1f(timeUniform, frameCount)\n    ctx.uniform2f(translateUniform, translate[0], translate[1])\n    ctx.uniform2f(scaleUniform, scale[0], scale[1])\n    ctx.drawArrays(ctx.TRIANGLE_STRIP, 0, 4)\n  }\n\n  const polyrat = new Polyrat(polynumber.coefficents)\n\n  return (\n    <section ref={ref} class={style.canvas_frame}>\n      <Helmet><title>{polynumber.title}</title></Helmet>\n      <div class=\"d-none\"><PolynumberPlaque path={polynumber.path} /></div>\n      <div class=\"offcanvas offcanvas-start\" data-bs-scroll=\"true\" data-bs-backdrop=\"false\" id=\"shaders\" aria-labelledby=\"shadersLabel\">\n        <div class=\"offcanvas-header\">\n          <h5 class=\"offcanvas-title\" id=\"shadersLabel\">Shaders</h5>\n          <button type=\"button\" class=\"btn-close text-reset\" data-bs-dismiss=\"parameterPanel\" aria-label=\"Close\" />\n        </div>\n        <div class=\"offcanvas-body\">\n          <form>\n            <div class=\"mb-3\">\n              <label for=\"vertexShader\">Vertex Shader</label>\n              <textarea class=\"form-control\" id=\"vertexShader\" rows={6}>{vertexShaderSource}</textarea>\n            </div>\n            <div class=\"mb-3\">\n              <label for=\"fragmentShader\">Fragment Shader</label>\n              <textarea class=\"form-control\" id=\"fragmentShader\" rows={20}>{fragmentShaderSource.replace('POLYNUMBER_FORMULA', polyrat.toGLSLFormula())}</textarea>\n            </div>\n          </form>\n        </div>\n      </div>\n      <div>\n        <GridOverlay setTranslate={setTranslate} setScale={setScale} />\n      </div>\n      <WebGL2 init={init} onResize={onResize} draw={draw} />\n    </section>\n  )\n}\n\nexport default PolynumberVisualizer\n","export default `#version 300 es\nin vec2 a_position;\nin vec4 a_color;\nout vec4 v_color;\n\nvoid main(void) {\n  gl_Position = vec4(a_position, 0.0, 1.0);\n  v_color = a_color;\n}\n`\n"],"sourceRoot":""}
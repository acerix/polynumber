{"version":3,"sources":["webpack:///./routes/common/webgl2/index.tsx","webpack:///./routes/common/canvas/style.css","webpack:///./routes/common/canvas/index.tsx","webpack:///./routes/common/grid-overlay/style.css","webpack:///./routes/common/grid-overlay/index.tsx","webpack:///./routes/polynumber/index.tsx","webpack:///./routes/polynumber/vertex.js","webpack:///./routes/polynumber/fragment.js"],"names":["defaultContextOptions","alpha","depth","preserveDrawingBuffer","WebGL2","props","getContext","init","ready","draw","onResize","framesPerSecond","rest","ref","createRef","frameMilliseconds","undefined","useEffect","renderCallbackID","canvas","current","paused","frameCount","ctx","alert","window","location","href","handleResize","width","innerWidth","height","innerHeight","addEventListener","handleBlur","handleFocus","setFullscreen","document","fullscreenElement","body","requestFullscreen","catch","err","console","error","render","setTimeout","requestAnimationFrame","whenReady","clearTimeout","cancelAnimationFrame","removeEventListener","Canvas","animate","loopCallbackID","loop","canvasMethodRefs","zoomFactor","microZoomFactor","free","axisLabelFormat","coefficient","exponent","repeat","replace","toFixed","GridOverlay","setTranslate","setScale","log","canvasCenter","translate","scale","velocity","xLabelOffset","yLabelOffset","contextHeight","clearRect","powerX","Math","ceil","log10","powerY","factorX","factorY","spaceX","spaceY","xIndexOffset","yIndexOffset","firstXPosition","firstYPosition","xLineCount","floor","yLineCount","xMiddleLineIndex","yMiddleLineIndex","beginPath","i","x","moveTo","lineTo","j","label","fillText","y","save","rotate","PI","restore","stroke","mouseDown","lastMousePosition","lastTouch1Position","lastTouch2Position","handleMouseDown","event","button","clientX","clientY","preventDefault","handleMouseUp","handleContextMenu","handleMouseMove","dx","dy","f","zoomTo","zoomLastPosition","zoomToPosition","handleTouchDown","touches","pageX","pageY","handleTouchUp","handleTouchMove","length","x1","y1","x2","y2","zoomModifier","touchMidpoint","deltaY","handleKeyDown","code","class","style","initialScale","strokeStyle","lineWidth","fillStyle","textAlign","font","halfWidth","halfHeight","initShader","gl","type","source","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","PolynumberVisualizer","path","library","default","shaderProgram","timeUniform","translateUniform","scaleUniform","polynumber","polyrat","Polyrat","coefficents","Helmet","title","id","for","rows","toGLSLFormula","program","positionAttrib","vertices","vertexBuffer","createProgram","fragmentShaderSource","getElementById","textContent","fragmentShader","FRAGMENT_SHADER","attachShader","vertexShaderSource","vertexShader","VERTEX_SHADER","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","useProgram","initProgram","getAttribLocation","Float32Array","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","vertexAttribPointer","FLOAT","enableVertexAttribArray","getUniformLocation","viewport","uniform1f","uniform2f","drawArrays","TRIANGLE_STRIP"],"mappings":"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","file":"route-polynumber.chunk.46329.js","sourcesContent":["import { FunctionalComponent, createRef, h } from 'preact'\nimport { useEffect } from 'preact/hooks'\n\ntype GetContextFunction = (webGL2: HTMLCanvasElement) => WebGL2RenderingContext\n\ntype InitFunction = (ctx: WebGL2RenderingContext) => void\n\ntype ReadyFunction = (whenReady: VoidFunction) => void\n\ntype DrawFunction = (ctx: WebGL2RenderingContext, frameCount: number) => void\n\ntype ResizeFunction = (ctx: WebGL2RenderingContext) => void\n\ninterface WebGL2Options {\n  contextType?: string;\n  framesPerSecond?: number;\n}\n\ninterface WebGL2Props {\n  getContext?: GetContextFunction;\n  init?: InitFunction;\n  ready?: ReadyFunction;\n  draw: DrawFunction;\n  onResize?: ResizeFunction;\n  framesPerSecond?: number;\n  options?: WebGL2Options;\n}\n\nconst defaultContextOptions = {\n  alpha: false,\n  depth: false,\n  preserveDrawingBuffer: true\n}\n\nexport const WebGL2: FunctionalComponent<WebGL2Props> = (props: WebGL2Props) => {\n  const { getContext, init, ready, draw, onResize, framesPerSecond, ...rest } = props\n  const ref = createRef()\n  const frameMilliseconds = framesPerSecond ? 1000 / framesPerSecond : undefined\n\n  useEffect(() => {\n    const canvas = ref.current as HTMLCanvasElement\n    let paused = false\n    let frameCount = -1\n    let renderCallbackID: number\n    const ctx = getContext ? getContext(canvas) : canvas.getContext('webgl2', defaultContextOptions) as WebGL2RenderingContext\n    if (!ctx) {\n      alert('Error getting context. WebGL2 is required.')\n      if (typeof window !== 'undefined') {\n        window.location.href='https://get.webgl.org/webgl2/'\n      }\n      return\n    }\n\n    const handleResize = (): void => {\n      ctx.canvas.width = window.innerWidth\n      ctx.canvas.height = window.innerHeight\n      if (onResize) onResize(ctx)\n    }\n    window.addEventListener('resize', handleResize)\n    handleResize()\n\n    const handleBlur = (): void => {\n      paused = true\n    }\n    window.addEventListener('blur', handleBlur)\n\n    const handleFocus = (): void => {\n      paused = false\n    }\n    window.addEventListener('focus', handleFocus)\n\n    const setFullscreen = (): void => {\n      if (!document.fullscreenElement) {\n        document.body.requestFullscreen().catch(err => {\n          console.error('Fullscreen fail:', err)\n        })\n      }\n    }\n    window.addEventListener('click', setFullscreen)\n\n    if (init) init(ctx)\n\n    const render = (): void => {\n      if (paused) {\n        setTimeout(render, 128)\n        return\n      }\n      frameCount++\n      if (frameMilliseconds) {\n        renderCallbackID = window.setTimeout(render, frameMilliseconds)\n      }\n      else {\n        renderCallbackID = window.requestAnimationFrame(render)\n      }\n      draw(ctx, frameCount)\n    }\n\n    const whenReady = (): void => {\n      setTimeout(render, 0)\n    }\n\n    if (ready===undefined) whenReady()\n    else ready(whenReady)\n\n    return (): void => {\n      if (frameMilliseconds) {\n        window.clearTimeout(renderCallbackID)\n      }\n      else {\n        window.cancelAnimationFrame(renderCallbackID)\n      }\n      window.removeEventListener('resize', handleResize)\n      window.removeEventListener('blur', handleBlur)\n      window.removeEventListener('focus', handleFocus)\n      window.removeEventListener('click', setFullscreen)\n    }\n\n  }, [getContext, init, ready, draw, onResize, ref, frameMilliseconds])\n\n  return <canvas ref={ref} {...rest} />\n}\n\nexport default WebGL2\n","// extracted by mini-css-extract-plugin\nexport default {\"canvas_frame\":\"canvas_frame__1myZW\",\"art_plaque\":\"art_plaque__2F3EQ\"};","import { FunctionalComponent, createRef, h } from 'preact'\nimport { useEffect } from 'preact/hooks'\n\ntype GetContextFunction = (canvas: HTMLCanvasElement) => CanvasRenderingContext2D\n\ntype InitFunction = (ctx: CanvasRenderingContext2D) => void\n\ntype ReadyFunction = (whenReady: VoidFunction) => void\n\ntype DrawFunction = (ctx: CanvasRenderingContext2D, frameCount: number) => void\n\ntype ResizeFunction = (ctx: CanvasRenderingContext2D) => void\n\ntype RenderFunction = () => void\n\nexport interface CanvasOptions {\n  contextType?: string;\n  framesPerSecond?: number;\n}\n\nexport interface CanvasMethods {\n  render: RenderFunction;\n}\n\nexport interface CanvasProps {\n  getContext?: GetContextFunction;\n  init?: InitFunction;\n  ready?: ReadyFunction;\n  draw: DrawFunction;\n  onResize?: ResizeFunction;\n  animate?: boolean;\n  framesPerSecond?: number;\n  options?: CanvasOptions;\n  canvasMethodRefs?: CanvasMethods;\n}\n\nconst Canvas: FunctionalComponent<CanvasProps> = (props: CanvasProps) => {\n  const { getContext, init, ready, draw, onResize, animate, framesPerSecond, ...rest } = props\n  const ref = createRef()\n  const frameMilliseconds = framesPerSecond ? 1000 / framesPerSecond : undefined\n\n  useEffect(() => {\n    const canvas = ref.current as HTMLCanvasElement\n    let paused = false\n    let frameCount = -1\n    let loopCallbackID: number\n    const ctx = getContext ? getContext(canvas) : canvas.getContext('2d') as CanvasRenderingContext2D\n\n    const handleResize = (): void => {\n      ctx.canvas.width = window.innerWidth\n      ctx.canvas.height = window.innerHeight\n      if (onResize) onResize(ctx)\n    }\n    window.addEventListener('resize', handleResize)\n    handleResize()\n\n    const handleBlur = (): void => {\n      paused = true\n    }\n    window.addEventListener('blur', handleBlur)\n\n    const handleFocus = (): void => {\n      paused = false\n    }\n    window.addEventListener('focus', handleFocus)\n\n    const setFullscreen = (): void => {\n      if (!document.fullscreenElement) {\n        document.body.requestFullscreen().catch(err => {\n          console.error('Fullscreen fail:', err)\n          // console.error(`Fullscreen fail: ${err.message} (${err.name})`)\n        })\n      }\n    }\n    window.addEventListener('click', setFullscreen)\n\n    if (init) init(ctx)\n\n    const render = (): void => {\n      draw(ctx, frameCount++)\n    }\n\n    const loop = (): void => {\n      if (paused) {\n        setTimeout(loop, 128)\n        return\n      }\n      frameCount++\n      if (frameMilliseconds) {\n        loopCallbackID = window.setTimeout(loop, frameMilliseconds)\n      }\n      else {\n        loopCallbackID = window.requestAnimationFrame(loop)\n      }\n      draw(ctx, frameCount)\n    }\n\n    // expose methods to parent\n    // @todo seems parents calling their children's methods is react antipattern, better way?\n    if (props.canvasMethodRefs) {\n      props.canvasMethodRefs.render = render\n    }\n\n    const whenReady = (): void => {\n      if (animate===false) {\n        setTimeout(render)\n      }\n      else {\n        setTimeout(loop)\n      }\n    }\n\n    if (ready===undefined) whenReady()\n    else ready(whenReady)\n\n    return (): void => {\n      if (frameMilliseconds) {\n        window.clearTimeout(loopCallbackID)\n      }\n      else {\n        window.cancelAnimationFrame(loopCallbackID)\n      }\n      window.removeEventListener('resize', handleResize)\n      window.removeEventListener('blur', handleBlur)\n      window.removeEventListener('focus', handleFocus)\n      window.removeEventListener('click', setFullscreen)\n    }\n\n  }, [getContext, init, ready, draw, onResize, ref, props.canvasMethodRefs, animate, frameMilliseconds])\n\n  return <canvas ref={ref} {...rest} />\n}\n\nexport default Canvas\n","// extracted by mini-css-extract-plugin\nexport default {\"grid_overlay\":\"grid_overlay__3wiLR\"};","import { FunctionalComponent, h } from 'preact'\nimport { useEffect } from 'preact/hooks'\nimport Canvas, { CanvasMethods } from '../../common/canvas'\nimport style from './style.css'\n\nconst logBase = 10\nconst zoomFactor = logBase**(1/13)\nconst microZoomFactor = zoomFactor**(1/32)\nconst minimumGridSpacing = 24\nconst μ = .9\nconst translateFactor = 16\nlet free = true\n\nexport const axisLabelFormat = (coefficient: number, exponent: number): string => {\n  if (coefficient === 0) return '0'\n  // simple notation for small exponents\n  if (exponent < 5) {\n    // @todo i18n eg. toLocaleString\n    if (exponent >= 0) {\n      // 1...10,000\n      return `${coefficient}${'0'.repeat(exponent)}`.replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')\n    }\n    if (exponent > -5) {\n      // 0...0.0001\n      return (coefficient*logBase**exponent).toFixed(-exponent)\n    }\n  }\n  // pseudoscientific notation, eg. 5×⏨42 for 5*10^42\n  return `${coefficient}×⏨${exponent}`\n}\n\ntype TranslateFunction = (x: number, y: number) => void\n\ntype ScaleFunction = (x: number, y: number) => void\n\nexport interface GridOverlayProps {\n  canvasMethodRefs?: CanvasMethods;\n  setTranslate?: TranslateFunction;\n  setScale?: ScaleFunction;\n  initialScale?: number;\n}\n\nexport const GridOverlay: FunctionalComponent<GridOverlayProps> = (props: GridOverlayProps) => {\n  const { setTranslate, setScale, ...rest } = props\n  const canvasMethodRefs = {render() {console.log('canvasMethodRefs.render()')}}\n  const canvasCenter = [0, 0]\n  const translate = [0, 0]\n  const scale = [1, 1]\n  const velocity = [0, 0]\n  const fontSize = 12\n  const axisLabelMargin = 4\n  // const xLabelOffset = [-axisLabelMargin, fontSize+axisLabelMargin] // incorrect with rotation\n  const xLabelOffset = [-2, 10]\n  const yLabelOffset = [-axisLabelMargin, -axisLabelMargin]\n  let contextHeight = 0\n\n  const init = (ctx: CanvasRenderingContext2D): void => {\n    const initialScale = rest.initialScale ?? 16/ctx.canvas.width\n    scale[0] = scale[1] = initialScale\n    if (setScale) {\n      setScale(scale[0], scale[1])\n    }\n    draw(ctx)\n  }\n\n  const onResize = (ctx: CanvasRenderingContext2D): void => {\n\n    // line styles\n    ctx.strokeStyle = '#999'\n    ctx.lineWidth = 1\n    \n    // text styles\n    ctx.fillStyle = '#fff'\n    ctx.textAlign = 'right'\n    ctx.font = `${fontSize}px monospace`\n    // @todo white on white bg in unreadable\n    // shadowBlur works ok but is too slow in Firefox\n    // ctx.shadowColor = 'rgba(0,0,0,1)'\n    // ctx.shadowBlur = 4\n\n    contextHeight = ctx.canvas.height\n    const halfWidth = ctx.canvas.width/2\n    const halfHeight = ctx.canvas.height/2\n    if (canvasCenter[0] === 0) {\n      // initially translate (0,0) to center of canvas\n      canvasCenter[0] = halfWidth\n      canvasCenter[1] = halfHeight\n      translate[0] = -canvasCenter[0]\n      translate[1] = -canvasCenter[1]\n    }\n    else {\n      // adjust translation by difference in canvas size\n      const dx = halfWidth - canvasCenter[0]\n      const dy = halfHeight - canvasCenter[1]\n      translate[0] -= dx\n      translate[1] -= dy\n      canvasCenter[0] = halfWidth\n      canvasCenter[1] = halfHeight\n    }\n    draw(ctx)\n  }\n\n  const render = (): void => {\n    if (canvasMethodRefs && 'render' in canvasMethodRefs) {\n      canvasMethodRefs.render()\n    }\n  }\n\n  const draw = (ctx: CanvasRenderingContext2D): void => {\n    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height)\n\n    // slow down due to friction\n    velocity[0] *= μ\n    velocity[1] *= μ\n\n    // glide\n    if (free) {\n      translate[0] += velocity[0]\n      translate[1] -= velocity[1]\n    }\n    \n    // exponent for axis labels ⏨(n+x)\n    const powerX = Math.ceil(Math.log10(minimumGridSpacing * scale[0]))\n    const powerY = Math.ceil(Math.log10(minimumGridSpacing * scale[1]))\n    const factorX = 10**powerX\n    const factorY = 10**powerY\n\n    // set space between lines\n    const spaceX = factorX / scale[0]\n    const spaceY = factorY / scale[1]\n\n    // get first lines by rounding up\n    const xIndexOffset = Math.ceil(translate[0] * scale[0] / factorX)\n    const yIndexOffset = Math.ceil(translate[1] * scale[1] / factorY) \n    const firstXValue = xIndexOffset * factorX\n    const firstYValue = yIndexOffset * factorY\n    const firstXPosition = firstXValue / scale[0] - translate[0]\n    const firstYPosition = translate[1] - firstYValue / scale[1]\n    \n    // lines to write labels on\n    const xLineCount = Math.floor(ctx.canvas.width / spaceX)\n    const yLineCount = Math.floor(ctx.canvas.height / spaceY)\n    const xMiddleLineIndex = Math.floor(xLineCount / 2)\n    const yMiddleLineIndex = Math.floor(yLineCount / 2)\n\n    ctx.beginPath()\n    // draw x-axis grid lines\n    for (let i=0; i<=xLineCount; i++) {\n      const x = firstXPosition + i * spaceX\n      ctx.moveTo(x, 0)\n      ctx.lineTo(x, ctx.canvas.height)\n      // draw y-axis labels up the middle line\n      if (i === xMiddleLineIndex) {\n        for (let j=0; j<=yLineCount; j++) {\n          const label = axisLabelFormat(j + yIndexOffset, powerY)\n          const y = firstYPosition + ctx.canvas.height - j * spaceY\n          ctx.fillText(label, x + yLabelOffset[0], y + yLabelOffset[1])\n        }\n      }\n    }\n    // draw y-axis grid lines\n    for (let i=0; i<=yLineCount; i++) {\n      const y = firstYPosition + ctx.canvas.height - i * spaceY\n      ctx.moveTo(0, y)\n      ctx.lineTo(ctx.canvas.width, y)\n      // draw x-axis labels below the middle line\n      if (i === yMiddleLineIndex) {\n        for (let j=0; j<=xLineCount; j++) {\n          const label = axisLabelFormat(j + xIndexOffset, powerX)\n          const x = firstXPosition + j * spaceX\n\n          // rotate: to avoid overlap with long labels and small grid\n          // @todo better to rotate once then draw all labels?\n          ctx.save()\n          ctx.translate(x + xLabelOffset[0], y + xLabelOffset[1])\n          ctx.rotate(-Math.PI/6)\n          ctx.fillText(label, 0, 0)\n          ctx.restore()\n\n          // without rotate:\n          // ctx.fillText(label, x + xLabelOffset[0], y + xLabelOffset[1])\n\n        }\n      }\n    }\n    ctx.stroke()\n\n    // update position of main canvas\n    if (setTranslate) {\n      setTranslate(translate[0], translate[1])\n    }\n  }\n\n  useEffect(() => {\n    let mouseDown = 0\n    let renderCallbackID: number\n    const lastMousePosition = [0, 0]\n    const lastTouch1Position = [-1, -1]\n    const lastTouch2Position = [-1, -1]\n\n    const handleMouseDown = (event: MouseEvent): boolean => {\n      mouseDown |= (1<<event.button)\n      lastMousePosition[0] = event.clientX\n      lastMousePosition[1] = event.clientY\n      velocity[0] = velocity[1] = 0\n      free = !(mouseDown&1)\n      event.preventDefault()\n      return false\n    }\n    window.addEventListener('mousedown', handleMouseDown)\n\n    const handleMouseUp = (event: MouseEvent): boolean => {\n      mouseDown ^= (1<<event.button)\n      event.preventDefault()\n      free = !(mouseDown&1)\n      return false\n    }\n    window.addEventListener('mouseup', handleMouseUp)\n\n    const handleContextMenu = (event: MouseEvent): boolean => {\n      event.preventDefault()\n      return false\n    }\n    window.addEventListener('contextmenu', handleContextMenu)\n\n    const handleMouseMove = (event: MouseEvent): void => {\n      const dx = lastMousePosition[0] - event.clientX\n      const dy = lastMousePosition[1] - event.clientY\n      const flingFactor = 4\n      // left-clicked, translate\n      if (mouseDown&1) {\n        velocity[0] = dx * flingFactor\n        velocity[1] = dy * flingFactor\n        translate[0] += dx\n        translate[1] -= dy\n        if (setTranslate) {\n          setTranslate(translate[0], translate[1])\n          render()\n        }\n      }\n      // middle-clicked, scale all axes\n      if (mouseDown&2) {\n        const f = microZoomFactor**-dy\n        scale[0] *= f\n        scale[1] *= f\n        if (setScale) {\n          setScale(scale[0], scale[1])\n          render()\n        } \n      }\n      // right-clicked, scale individual axes\n      if (mouseDown&4) {\n        const zoomTo = [\n          (lastMousePosition[0] + translate[0]) * scale[0],\n          (contextHeight - lastMousePosition[1] + translate[1]) * scale[1]\n        ]\n        const zoomLastPosition = [\n          zoomTo[0] / scale[0] - translate[0],\n          zoomTo[1] / scale[1] - translate[1]\n        ]\n        scale[0] *= microZoomFactor**dx\n        scale[1] *= microZoomFactor**-dy\n        if (setScale) {\n          setScale(scale[0], scale[1])\n        }\n        const zoomToPosition = [\n          zoomTo[0] / scale[0] - translate[0],\n          zoomTo[1] / scale[1] - translate[1]\n        ]\n        translate[0] -= zoomLastPosition[0] - zoomToPosition[0] - dx\n        translate[1] += zoomToPosition[1] - zoomLastPosition[1] - dy\n        if (setTranslate) {\n          setTranslate(translate[0], translate[1])\n        }\n        render()\n      }\n      lastMousePosition[0] = event.clientX\n      lastMousePosition[1] = event.clientY\n    }\n    window.addEventListener('mousemove', handleMouseMove)\n\n    const handleTouchDown = (event: TouchEvent): boolean => {\n      lastTouch1Position[0] = event.touches[0].pageX\n      lastTouch1Position[1] = event.touches[0].pageY\n      velocity[0] = velocity[1] = 0\n      free = false\n      return false\n    }\n    window.addEventListener('touchstart', handleTouchDown)\n\n    const handleTouchUp = (event: TouchEvent): boolean => {\n      void(event)\n      lastTouch1Position[0] = lastTouch1Position[1] = -1\n      free = true\n      return false\n    }\n    window.addEventListener('touchend', handleTouchUp)\n\n    const handleTouchMove = (event: TouchEvent): void => {\n      if (lastTouch1Position[0] > -1) {\n        if (event.touches.length===1) {\n          const dx = lastTouch1Position[0] - event.touches[0].pageX\n          const dy = lastTouch1Position[1] - event.touches[0].pageY\n          velocity[0] = dx\n          velocity[1] = dy\n          translate[0] += dx\n          translate[1] -= dy\n          lastTouch2Position[0] = lastTouch2Position[1] = -1\n          if (setTranslate) {\n            setTranslate(translate[0], translate[1])\n            render()\n          }\n        }\n        else {\n          if (lastTouch2Position[0] > -1) {\n            const x1 = event.touches[0].pageX\n            const y1 = event.touches[0].pageY\n            const x2 = event.touches[1].pageX\n            const y2 = event.touches[1].pageY\n            const q1 = (lastTouch1Position[0] - lastTouch2Position[0])**2 + (lastTouch1Position[1] - lastTouch2Position[1])**2\n            const q2 = (x1 - x2)**2 + (y1 - y2)**2\n            const zoomModifier = q1 / q2\n            const touchMidpoint = [\n              (x1 + x2) / 2,\n              (y1 + y2) / 2\n            ]\n            const zoomTo = [\n              (touchMidpoint[0] + translate[0]) * scale[0],\n              (contextHeight - touchMidpoint[1] + translate[1]) * scale[1]\n            ]\n            const zoomLastPosition = [\n              zoomTo[0] / scale[0] - translate[0],\n              zoomTo[1] / scale[1] - translate[1]\n            ]\n            scale[0] *= zoomModifier\n            scale[1] *= zoomModifier\n            if (setScale) {\n              setScale(scale[0], scale[1])\n            }\n            const zoomToPosition = [\n              zoomTo[0] / scale[0] - translate[0],\n              zoomTo[1] / scale[1] - translate[1]\n            ]\n            translate[0] -= zoomLastPosition[0] - zoomToPosition[0]\n            translate[1] += zoomToPosition[1] - zoomLastPosition[1]\n            if (setTranslate) {\n              setTranslate(translate[0], translate[1])\n            }\n            render()\n          }\n          lastTouch2Position[0] = event.touches[1].pageX\n          lastTouch2Position[1] = event.touches[1].pageY\n        }\n      }\n      lastTouch1Position[0] = event.touches[0].pageX\n      lastTouch1Position[1] = event.touches[0].pageY\n    }\n    window.addEventListener('touchmove', handleTouchMove)\n\n    const handleWheel = (event: WheelEvent): void => {\n      const zoomModifier = event.deltaY > 0 ? zoomFactor : 1/zoomFactor\n      const zoomTo = [\n        (lastMousePosition[0] + translate[0]) * scale[0],\n        (contextHeight - lastMousePosition[1] + translate[1]) * scale[1]\n      ]\n      const zoomLastPosition = [\n        zoomTo[0] / scale[0] - translate[0],\n        zoomTo[1] / scale[1] - translate[1]\n      ]\n      scale[0] *= zoomModifier\n      scale[1] *= zoomModifier\n      if (setScale) {\n        setScale(scale[0], scale[1])\n      }\n      const zoomToPosition = [\n        zoomTo[0] / scale[0] - translate[0],\n        zoomTo[1] / scale[1] - translate[1]\n      ]\n      translate[0] -= zoomLastPosition[0] - zoomToPosition[0]\n      translate[1] += zoomToPosition[1] - zoomLastPosition[1]\n      if (setTranslate) {\n        setTranslate(translate[0], translate[1])\n      }\n      render()\n    }\n    window.addEventListener('wheel', handleWheel)\n\n    const handleKeyDown = (event: KeyboardEvent): void => {\n      switch (event.code) {\n  \n      case 'KeyW':\n      case 'ArrowUp':\n      case 'Numpad8':\n        translate[1] -= translateFactor * zoomFactor\n        break\n            \n      case 'KeyS':\n      case 'ArrowDown':\n      case 'Numpad2':\n        translate[1] += translateFactor * zoomFactor\n        break\n             \n      case 'KeyA':\n      case 'ArrowLeft':\n      case 'Numpad4':\n        translate[0] += translateFactor * zoomFactor\n        break\n            \n      case 'KeyD':\n      case 'ArrowRight':\n      case 'Numpad6':\n        translate[0] -= translateFactor * zoomFactor\n        break\n \n      case 'NumpadSubtract':\n      case 'Minus':\n        scale[0] *= zoomFactor\n        scale[1] *= zoomFactor\n        if (setScale) {\n          setScale(scale[0], scale[1])\n          render()\n        } \n        break\n \n      case 'NumpadAdd':\n      case 'Equal':\n        scale[0] /= zoomFactor\n        scale[1] /= zoomFactor\n        if (setScale) {\n          setScale(scale[0], scale[1])\n          render()\n        } \n        break\n  \n      }\n    }\n    window.addEventListener('keydown', handleKeyDown)\n\n    return (): void => {\n      window.cancelAnimationFrame(renderCallbackID)\n      window.removeEventListener('mousedown', handleMouseDown)\n      window.removeEventListener('mouseup', handleMouseUp)\n      window.removeEventListener('contextmenu', handleContextMenu)\n      window.removeEventListener('mousemove', handleMouseMove)\n      window.removeEventListener('touchstart', handleTouchDown)\n      window.removeEventListener('touchend', handleTouchUp)\n      window.removeEventListener('touchmove', handleTouchMove)\n      window.removeEventListener('keypress', handleKeyDown)\n    }\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  return (\n    <div class={style.grid_overlay} {...rest}>\n      <Canvas canvasMethodRefs={canvasMethodRefs} init={init} onResize={onResize} draw={draw} animate={true} />\n    </div>\n  )\n}\n\nexport default GridOverlay\n","/* eslint-disable @typescript-eslint/no-unsafe-argument */\nimport { createRef, FunctionalComponent, h } from 'preact'\nimport Helmet from 'react-helmet'\nimport WebGL2 from '../common/webgl2'\nimport NotFound from '../not-found'\nimport style from '../common/canvas/style.css'\nimport fragmentShaderSource from './fragment.js'\nimport vertexShaderSource from './vertex.js'\nimport GridOverlay from '../common/grid-overlay'\nimport library from '../polynumbers/library'\nimport { PolynumberPlaque } from '../polynumbers/meta'\nimport Polyrat from 'cnum/dist/tsc/Polyrat'\n\nconst initShader = (gl: WebGL2RenderingContext, type: number, source: string): WebGLShader => {\n  const shader = gl.createShader(type)\n  if (!shader) {\n    throw 'Missing shader'\n  }\n  gl.shaderSource(shader, source)\n  gl.compileShader(shader)\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    throw gl.getShaderInfoLog(shader)\n  }\n  return shader\n}\n\nconst initProgram = (gl: WebGL2RenderingContext): WebGLProgram => {\n  const program = gl.createProgram()\n  if (!program) {\n    throw 'Missing program'\n  }\n  const fragmentShaderSource = document.getElementById('fragmentShader')?.textContent\n  if (!fragmentShaderSource) {\n    throw 'Missing fragmentShaderSource'\n  }\n  const fragmentShader = initShader(gl, gl.FRAGMENT_SHADER, fragmentShaderSource)\n  gl.attachShader(program, fragmentShader)\n  const vertexShaderSource = document.getElementById('vertexShader')?.textContent\n  if (!vertexShaderSource) {\n    throw 'Missing vertexShaderSource'\n  }\n  const vertexShader = initShader(gl, gl.VERTEX_SHADER, vertexShaderSource)\n  gl.attachShader(program, vertexShader)\n  gl.linkProgram(program)\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n    throw gl.getProgramInfoLog(program)??'Error from getProgramParameter'\n  }\n  gl.useProgram(program)\n  return program\n}\n\ninterface Props {\n  path: keyof typeof library;\n}\n\nconst PolynumberVisualizer: FunctionalComponent<Props> = (props: Props) => {\n  const { path } = props\n  \n  if (!(path in library)) {\n    return <NotFound default />\n  }\n  const polynumber = library[path]\n\n  const ref = createRef<HTMLElement>()\n  let shaderProgram: WebGLProgram\n  let timeUniform: WebGLUniformLocation|null\n  let translateUniform: WebGLUniformLocation|null\n  let scaleUniform: WebGLUniformLocation|null\n  const translate = [0, 0]\n  const scale = [1, 1]\n\n  const bindBuffers = (gl: WebGL2RenderingContext, program: WebGLProgram): void => {\n    const positionAttrib = gl.getAttribLocation(program, 'a_position')\n    const vertices = new Float32Array([\n      +1, +1, +0,\n      -1, +1, +0,\n      +1, -1, +0,\n      -1, -1, +0\n    ])\n    const vertexBuffer = gl.createBuffer()\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer)\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW)\n    gl.vertexAttribPointer(positionAttrib, 3, gl.FLOAT, false, 0, 0)\n    gl.bindBuffer(gl.ARRAY_BUFFER, null) // unbind\n    gl.enableVertexAttribArray(positionAttrib)\n    timeUniform = gl.getUniformLocation(program, 'u_time')\n    translateUniform = gl.getUniformLocation(program, 'u_translate')\n    scaleUniform = gl.getUniformLocation(program, 'u_scale')\n  }\n  \n  const init = (ctx: WebGL2RenderingContext): void => {\n    translate[0] = -ctx.canvas.width/2\n    translate[1] = -ctx.canvas.height/2\n    shaderProgram = initProgram(ctx)\n    bindBuffers(ctx, shaderProgram)\n  }\n\n  const onResize = (ctx: WebGL2RenderingContext): void => {\n    ctx.viewport(0, 0, ctx.canvas.width, ctx.canvas.height)\n  }\n\n  const setTranslate = (x: number, y: number): void => {\n    translate[0] = x\n    translate[1] = y\n  }\n\n  const setScale = (x: number, y: number): void => {\n    scale[0] = x\n    scale[1] = y\n    setTranslate(0, 0)\n  }\n\n  const draw = (ctx: WebGL2RenderingContext, frameCount: number): void => {\n    ctx.uniform1f(timeUniform, frameCount)\n    ctx.uniform2f(translateUniform, translate[0], translate[1])\n    ctx.uniform2f(scaleUniform, scale[0], scale[1])\n    ctx.drawArrays(ctx.TRIANGLE_STRIP, 0, 4)\n  }\n\n  const polyrat = new Polyrat(polynumber.coefficents)\n\n  return (\n    <section ref={ref} class={style.canvas_frame}>\n      <Helmet><title>{polynumber.title}</title></Helmet>\n      <div class=\"d-none\"><PolynumberPlaque path={polynumber.path} /></div>\n      <div class=\"offcanvas offcanvas-start\" data-bs-scroll=\"true\" data-bs-backdrop=\"false\" id=\"shaders\" aria-labelledby=\"shadersLabel\">\n        <div class=\"offcanvas-header\">\n          <h5 class=\"offcanvas-title\" id=\"shadersLabel\">Shaders</h5>\n          <button type=\"button\" class=\"btn-close text-reset\" data-bs-dismiss=\"parameterPanel\" aria-label=\"Close\" />\n        </div>\n        <div class=\"offcanvas-body\">\n          <form>\n            <div class=\"mb-3\">\n              <label for=\"vertexShader\">Vertex Shader</label>\n              <textarea class=\"form-control\" id=\"vertexShader\" rows={6}>{vertexShaderSource}</textarea>\n            </div>\n            <div class=\"mb-3\">\n              <label for=\"fragmentShader\">Fragment Shader</label>\n              <textarea class=\"form-control\" id=\"fragmentShader\" rows={20}>{fragmentShaderSource.replace('POLYNUMBER_FORMULA', polyrat.toGLSLFormula())}</textarea>\n            </div>\n          </form>\n        </div>\n      </div>\n      <div>\n        <GridOverlay setTranslate={setTranslate} setScale={setScale} />\n      </div>\n      <WebGL2 init={init} onResize={onResize} draw={draw} />\n    </section>\n  )\n}\n\nexport default PolynumberVisualizer\n","export default `#version 300 es\nin vec2 a_position;\nin vec4 a_color;\nout vec4 v_color;\n\nvoid main(void) {\n  gl_Position = vec4(a_position, 0.0, 1.0);\n  v_color = a_color;\n}\n`\n","export default `#version 300 es\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#define TAU 6.2831853071795865\n\nuniform float u_time;\nuniform vec2 u_translate;\nuniform vec2 u_scale;\nout vec4 fragmentColor;\n\nvoid main() {\n  float x = ( gl_FragCoord.x + u_translate.x ) * u_scale.x;\n  float y = ( gl_FragCoord.y + u_translate.y ) * u_scale.y;\n\n  // the curve is where this evaluates to 0, otherwise this is the \"distance\" to it\n  float z = POLYNUMBER_FORMULA;\n\n  // draw the curve as full green, tapering out to zero at a distance of 1\n  float d = 1.0 - abs(z);\n  fragmentColor.g = d < 0.0 ? 0.0 : pow(d, 16.0);\n\n  // draw the fractional part of z as blue, the integer values can be seen as black-blue barriers\n  fragmentColor.b = mod(z + u_time / 67.0, 1.0);\n\n  // draw a sin wave through zed in red\n  fragmentColor.r = sin(z * TAU - u_time / 11.0);\n}\n`"],"sourceRoot":""}